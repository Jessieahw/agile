<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>BBL Stats</title>
  <meta name="description" content="Big Bash League – compare players, teams and seasons">
  <meta name="author"      content="praj107">

  <!-- styles & scripts -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/bbl_main.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/bbl_results.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/bbl_team_results.css') }}">
  <!-- Add EChart.js to show graphs and other visualization -->
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script src="{{ url_for('static', filename='js/bbl.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/navbarscript.js') }}" defer></script>
  <link rel="icon" href="{{ url_for('static', filename='assets/favicon.png') }}" type="image/x-icon">
</head>

<body>
  <!-- ===== HEADER / NAV ===== -->
  <header>
    <nav class="navbar">
      <button class="nav-btn" data-target="home" id="homebtn">Home</button>
      <button class="nav-btn" data-target="stats" id="statsbtn">Stats & You</button>

      <img src="{{ url_for('static', filename='assets/bbl_nav_logo.png') }}" alt="Big Bash League Logo" class="nav-logo">

      <button class="nav-btn" data-target="players" id="playersbtn">Players</button>
      <button class="nav-btn" data-target="teams" id="teamsbtn">Teams</button>
    </nav>
  </header>

  <!-- ===== MAIN ===== -->
  <main>
    <!-- hero banner -->
    <section class="front-banner">
      <div class="front-banner-bg"></div>
      <h1 class="banner-title">
        Which BBL player are you most similar to?
      </h1>
    </section>

    <!-- Page sections -->
    <article id="home" class="page-content active">
      <div class="intro-box">
        <h2>Big Bash League – How do you fare?</h2>
        <p>Add your data below to see which player and team you resemble.</p>
      </div>

      <!-- ===== USER INPUT TABLES ===== -->
      <form id="user-stats-form" class="stats-form" action="" method="post">
        <!-- CSRF Token -->
        {{ form.hidden_tag() }}
        <!-- Batting -->
        <table class="stat-table">
          <caption>Batting&nbsp;Stats</caption>
          <tbody>
            <tr>
              <td>Innings Played</td>
              <td><input type="number" name="bat_innings" min="0" required></td>
            </tr>
            <tr>
              <td>Total Runs</td>
              <td><input type="number" name="bat_runs" min="0" required></td>
            </tr>
            <tr>
              <td>Highest Score</td>
              <td><input type="number" name="bat_high" min="0" required></td>
            </tr>
            <tr>
              <td>Batting Average</td>
              <td><input type="number" name="bat_avg" min="0" step="0.01" required></td>
            </tr>
            <tr>
              <td>Strike-Rate</td>
              <td><input type="number" name="bat_sr" min="0" step="0.01" required></td>
            </tr>
          </tbody>
        </table>

        <!-- Bowling -->
        <table class="stat-table">
          <caption>Bowling&nbsp;Stats</caption>
          <tbody>
            <tr>
              <td>Overs Bowled</td>
              <td><input type="number" name="bowl_overs" min="0" step="0.1" required></td>
            </tr>
            <tr>
              <td>Wickets Taken</td>
              <td><input type="number" name="bowl_wkts" min="0" required></td>
            </tr>
            <tr>
              <td>Runs Conceded</td>
              <td><input type="number" name="bowl_runs" min="0" required></td>
            </tr>
            <tr>
              <td>Bowling Average</td>
              <td><input type="number" name="bowl_avg" min="0" step="0.01" required></td>
            </tr>
            <tr>
              <td>Economy Rate</td>
              <td><input type="number" name="bowl_eco" min="0" step="0.01" required></td>
            </tr>
          </tbody>
        </table>

        <button class="submit-btn" type="submit">
          <span class="flip-box">
            <span class="flip-face flip-face-front">Compare my stats</span>
            <span class="flip-face flip-face-back">Submit</span>
          </span>
        </button>
      </form>
      {% if matches_bat or matches_bowl %}
        <div class="similar-results-flex">

          {% if matches_bat %}
            <div class="similar-results">
              <h3>Top 10 Similar Batters</h3>
              <table class="similar-table">
                <thead>
                  <tr>
                    <th class="rank">#</th>
                    <th>Name</th>
                    <th>Innings Played</th>
                    <th>Total Runs</th>
                    <th>Highest Score</th>
                    <th>Batting Average</th>
                    <th>Strike Rate</th>
                  </tr>
                </thead>
                <tbody>
                  {% for p in matches_bat %}
                  <tr>
                    <td class="rank">{{ loop.index }}</td>
                    <td>{{ p.name }}</td>
                    <td>{{ p.innings }}</td>
                    <td>{{ p.runs }}</td>
                    <td>{{ p.high_score }}</td>
                    <td>{{ '%.2f' % p.bat_avg }}</td>
                    <td>{{ '%.2f' % p.bat_sr }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% endif %}

          {% if matches_bowl %}
            <div class="similar-results">
              <h3>Top 10 Similar Bowlers</h3>
              <table class="similar-table">
                <thead>
                  <tr>
                    <th class="rank">#</th>
                    <th>Name</th>
                    <th>Overs Bowled</th>
                    <th>Wickets</th>
                    <th>Runs Conceded</th>
                    <th>Bowling Average</th>
                    <th>Economy Rate</th>
                  </tr>
                </thead>
                <tbody>
                  {% for p in matches_bowl %}
                  <tr>
                    <td class="rank">{{ loop.index }}</td>
                    <td>{{ p.name }}</td>
                    <td>{{ p.overs }}</td>
                    <td>{{ p.wickets }}</td>
                    <td>{{ p.runs_conceded }}</td>
                    <td>{{ '%.2f' % p.bowl_avg }}</td>
                    <td>{{ '%.2f' % p.eco }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% endif %}

        </div>
      {% endif %}
    </article>

    <!-- other articles unchanged -->
    <article id="stats" class="page-content">
      <div class="intro-box">
        <h2>Your Stats &amp; You</h2>
        <p>Visual comparison of your numbers vs the five most similar pros.</p>
      </div>

      {% if user_stats %}
      <div class="radar-container">
        {% if user_stats.bat_innings %}
          <h3>Batting Comparison</h3>
          <div id="bat-radar"  style="width:550px;height:420px"></div>
        {% endif %}
        {% if user_stats.bowl_overs %}
          <h3>Bowling Comparison</h3>
          <div id="bowl-radar" style="width:550px;height:420px"></div>
        {% endif %}
      </div>
      {% endif %}
    </article>
    <!-- Dump the three data blobs so bbl.js can reuse them -->
    {% if user_stats %}
    <script>
      window.userStats  = {{ user_stats  | tojson }};
      window.matchesBat = {{ matches_bat | tojson }};
      window.matchesBowl= {{ matches_bowl| tojson }};
    </script>
    {% endif %}

    <article id="players" class="page-content">
      <div class="intro-box">
        <h2>Players</h2>
        <p>Search the stats of every BBL player.</p>
      </div>
      <section class="search-section">
        <input type="text" id="player-search-input" placeholder="Enter player name…">
        <button id="player-search-btn">Search</button>
      </section>
      <div id="player-results"></div>
    </article>

    <article id="teams" class="page-content">
      <div class="intro-box">
        <h2>Teams</h2>
        <p>Explore team-level performance across all seasons.</p>
      </div>
      <article id="team‑search" class="section‐panel">
        <select id="team‑select" class="team‑select">
          <option value="">Select a team…</option>
        </select>
        <div id="team‑results" class="team‑results"></div>
      </article>
      
  </main>

  <!-- ===== FOOTER ===== -->
  <footer>
    <p>© Big Bash League Stats — Work in Progress</p>
  </footer>
</body>
</html>
